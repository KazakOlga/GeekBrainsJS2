(()=>{"use strict";class t{constructor(t,e){this._text=t,this._callback=e}onBtnClick(){const t=this._callback;"function"==typeof t&&t()}getTemplate(){const t=document.createElement("button");return t.classList.add("btn"),t}render(t){if(t){const e=this.getTemplate();e.innerHTML=this._text,t.appendChild(e),e.addEventListener("click",(()=>{this.onBtnClick()}))}}}class e{constructor({name:t,price:e,img:s,desc:n},i){this._name=t,this._price=e,this._img=s,this._desc=n,this._CartInstane=i}addToCart(){this._CartInstane.add(this),console.log("Added!",this._name)}render(e){const s=document.createElement("div");s.classList.add("shop_block"),s.innerHTML=`\n        <a href="#"><img class="shop_img" src="${this._img}" alt="img"></a>\n        <div class="shop_content_box">\n            <a href="#" class="shop_name">${this._name}</a>\n            <p class="main_text mts ">${this._desc}</p>\n            <div class="price">$${this._price}</div>\n        </div>`,new t("Add to cart",this.addToCart.bind(this)).render(s),e.appendChild(s)}}class s{constructor({name:t,price:e,img:s}){this._name=t,this._price=e,this._img=s}render(t){const e=document.createElement("div");e.innerHTML=`<div class="cart_content_product_inform center">\n        <div class="cart_content__product">\n            <img src="${this._img}" alt="product_photo">\n            <div class="cart_content__product_info">\n                <div class="cc_heading">\n                    <h3 class="cart_content__heading">${this._name}</h3>\n                    <img class="krestik" src="img/krestik.svg" alt="">\n                </div>\n                <p class="cc_text">Price: <span class="color_price">$${this._price}</span> </p>\n                <div class="ccq">\n                    <p class="cc_text">Quantity:${this.counter} </p>\n\n                </div>\n            </div>\n        </div>`,t.appendChild(e)}}const n=new class{add(t){const e=this._items.find((e=>e._name===t._name));e?e.counter++:this._items.push(new s({name:t._name,price:t._price,img:t._img})),this.render()}render(){const t=document.querySelector(".cart-list");t&&(t.innerHTML=""),this._items.forEach((e=>{e.render(t)}))}};new class{constructor(t){this._CartInstane=t,this.initShowMoreButton(),this.fetchGoods()}initShowMoreButton(){const t=document.querySelector(".browse_button");t&&t.addEventListener("click",(()=>{this._page++,this.fetchGoods()}))}fetchGoods(){this.preloading=!0;const t=`/database/items${this._page}.json`;return fetch(t).then((t=>t.json())).then((t=>{this.preloading=!1;const s=t.data.map((t=>new e(t,this._CartInstane)));return this._items=[...this._items,...s],this._items})).then(this.render.bind(this)).catch((t=>{alert("No more pages")}))}render(){const t=document.querySelector(".shop_content");t&&(t.innerHTML="",this._items.forEach((e=>{e.render(t)})))}}(n)})();